{% extends 'base.html' %}
{% load staticfiles %}
{% block head %}
<title>My Projects | Dissnitt</title>
<link rel="stylesheet" href="{% static 'todo/css/todo.css' %}">
{% endblock %}
{% block page_header %}<h1>Current Projects</h1>{% endblock %}
{% block sidepage %}
<hr>
<a href="{% url 'todo:new_project' %}">New Project</a><br>
{% endblock %}
{% block content %}

    <div class="todo_info">
        <table>
            <tr class="todo_table_header">
                <th class="btd"></th>
                <th class="ptd">P</th>
                <th class="ntd">Name</th>
                <th class="ctd">Created</th>
                <th class="dtd">Description</th>
                <th class="cotd">C?</th>
                <th></th>
                <th></th>
            </tr>
        </table>
         {% for project in latest_project_list %}
        <table>
            <tr>
                <td class="btd"><button onclick="toggleTasks('pr_{{project.id}}')">Tasks</button></td>
                <td class="ptd" >{{ project.priority }}</td>
                <td class="ntd"><a href="{% url 'todo:detail' project.id %}">{{ project.project_name }}</a></td>
                <td class="ctd">{{ project.created_date | date:"M d,Y"}}</td>
                <td class="dtd">{{ project.description }}</td>
                <td class="cotd">{{ project.completed }}</td>
                <td><a href="{% url 'todo:edit_project' project.id %}">Edit</a></td>
                <td><a href="{% url 'todo:delete_project' project.id %}">Delete</a></td>
            </tr>
        </table>

        <table id="pr_{{project.id}}" >

         {% for task in project.task_set.all %}
            <tr>
                <td class="btd"></td>
                <td class="ptd">{{ task.priority }}</td>
                <td class="ntd">{{ task.task_name }}</td>
                <td class="ctd">{{ task.created_date | date:"M d,Y" }}</td>
                <td class="dtd">{{ task.description }}</td>
                <td class="cotd">{{ task.completed }}</td>
                <td></td>
                <td></td>
            </tr>
          {% endfor %}
        </table>
        {% endfor %}
    </div>

<script>
    function toggleTasks(id) {
        var x = document.getElementById(id);
        if (x.style.display === 'none') {
            x.style.display = 'block';
        } else {
            x.style.display = 'none';
        }
    }
</script>
{% endblock %}